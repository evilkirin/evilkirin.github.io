---
layout: post
category: thoughts
---

Last week is a tough one. 我在自己即将开始的程序员生涯里边第一次真正遇到了挫折，so embarrassing。我负责完成的一个比较“简单”（原本我是这么认为的）功能在最后要进入预发阶段时被师兄检查出一个main bug。一旦这些代码被release出去，不仅是我，我所在的团队都会遇到较大的麻烦。后果是不堪设想的。尽管我努力去适应这边的工作环境，尽管机器性能始终在hold me back，但是这都不能成为我犯下的错误的接口。为此，我觉得必须有所记录，必须能够让将来的自己有所警惕。

## 生活方面

这段时间的生活实在是有太不规律，我有两天晚上甚至是在两点半之后才入眠（一点半上床），玩游戏是一方面，上床之后看动画片看剧是另一个主要因素。之后要么二选一，最好的是直接抛弃游戏。

## 方法层面

方法上有较多问题，而且这些东西比起具体的代码上的问题，改起来要更难一些。

### 再简单的功能实现起来也可能很复杂

就拿这次的创建自定义分组来说，从业务逻辑上来看，就仅仅是CRUD中Create这么一个功能。但是因为工作量和用户体验的原因，需要使用异步的方式来实现。而这个过程中要调用大量的第三方（或者二方）接口，不管是模块内部方法还是hsf接口。总是实现流程对我这个菜鸟来说并不太容易，而自己又太大意，或有一些许的轻视它，最后导致了前面提到的错误。

### 他人编写API的使用

在创建自定义分组的过程中，需要过滤用户列表。过滤时需要使用用户关系管理这么一个API，其中提供的方法能够判断一个买家是否是一个卖家公众账号的粉丝。在完成这项工作时我犯了两个错误，第一个是在实现初期时，将卖家和买家作为参数传入API时弄反了，第二个错误是在判断粉丝关系时使用的方法错误了。我原本使用的是获取一个卖家的所有粉丝，然后把所有买家的ID挨个取出判断是否包含在卖家的粉丝群中。这个流程看起来是能够work的，但是问题就在于一个卖家的所有粉丝可能是十万百万数量级的，这样的数据是不可能存储在缓存中的，而这个关系API提供的方法中只有获取缓存中保存的最近2000个粉丝，而没有从数据库中获取所有粉丝的功能（当然，这也不切实际）。

更为合理也是真正能够工作的方式是取出一个买家，然后判断当前卖家是否在他所关注的公众账号列表中。一切解决。我觉得，真实暴露出来的问题在于我真的没有认识到问题的严重性，现在与我一起工作的人都是正式员工，他们写的代码再不济都已经是正式上线产品的一部分。我觉得我现在最需要做的就是正视这一点，我还需要学的东西还有很多。

### 在跟别人讨论或理解别人工作的时候

需要谨记以下几个东西：

1. 你是新人，不能理解是你的问题。你需要思考更多，以真正体会其中的关节。
2. 如果你已经不是新人了，但是你在这个问题上依旧是新人，你理解不了，依旧是你自己的问题。
3. 你自认为自己理解，但是你很粗心，所以仍旧是你的问题。

不是说要不停的否定自己，而是说你要更加专注投入更多的脑力去思考，真正确定了你透透彻彻地理解了再去跟别人争辩也不迟的。

### Some trivial staff

* 方法写给别人用，但是自己其实是用的最多的人（可能是这种情况）。我遇到过自己写的代码在一个星期之后看不懂了。当时要求高一点，也许之后就不需要花那么多时间去理解了。
* 接下来可能会看到很多没有文档的代码，所以需要进一步提高阅读代码的能力。

## 代码相关

这些问题需要常看常思考才能够真正渗入自己写代码的习惯中。

1. 在关键位置打印日志，不管是debug还是warn，最好做到详细。
2. 处理数据，特别是海量数据时，make sure take both cache and DB into consideration.
3. NPE，老生常谈，当然，是别人的。
4. 统一处理Exception，校验输入参数。

正如师兄景升说的，对待未知的东西要更加警惕，在实际情况中，一切都有可能发生。

